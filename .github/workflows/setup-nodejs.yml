name: NodeJS Setup and Install Express

on:
  push:
    branches: [ master ]

jobs:
  setup-node:
    runs-on: my-runners

    steps:
      - name: "Debug: Starting checkout"
        run: echo "ğŸ” Starting checkout step..."

      - name: Checkout repository
        uses: actions/checkout@v4

      - name: "Debug: Setting up Node.js"
        run: echo "âš™ï¸ Setting up Node.js version 22..."

      - name: Setup Node.js 22
        uses: actions/setup-node@v4
        with:
          node-version: '22'

      - name: Verify Node & npm versions
        run: |
          echo "ğŸ”§ Checking Node.js and npm versions..."
          echo "Node version:"
          node -v
          echo "npm version:"
          npm -v

      - name: Install dependencies
        run: |
          echo "ğŸ“¦ Running npm install to install project dependencies..."
          npm install fs

      - name: Install Express
        run: |
          echo "ğŸš€ Installing Express framework..."
          npm install express
          echo "âœ… Express installation completed."

  execute-sonarqube-scan:
    needs: setup-node
    runs-on: my-runners

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Execute SonarQube Scan
        run: |
          echo "ğŸ” Starting SonarQube scan..."
          # Add your SonarQube scan commands here
          echo "âœ… SonarQube scan completed."

  parallel-stage-1:
    needs: [setup-node]
    runs-on: my-runners

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Run Parallel Task 1
        run: |
          echo "ğŸ”„ Running parallel task 1..."
          # Add your commands for parallel task 1 here
          echo "âœ… Parallel task 1 completed."

  parallel-stage-2:
    needs: [setup-node]
    runs-on: my-runners

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Run Parallel Task 2
        run: |
          echo "ğŸ”„ Running parallel task 2..."
          # Add your commands for parallel task 2 here
          echo "âœ… Parallel task 2 completed."
